par(mfrow=c(3,2),mar=c(5,2,3,2),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb)
qqnorm(testeb);qqline(testeb)
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(5,2,5,2),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb)
qqnorm(testeb);qqline(testeb)
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(6,2,6,2),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb)
qqnorm(testeb);qqline(testeb)
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(6,2,6,2),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(1,2,1,2),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(2,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(2,1,4,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(2,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(5,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(8,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB,G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
}
shapiro.test(testcml)
a=shapiro.test(testcml)
a$p.value
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
shapirop=c()
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
shapirop=c(shapirop,c(shapiro.test(testcml)$p.value,shapiro.test(testeb)$p.value))
}
print(shapirop)
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
shapirop=c()
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
shapirop=c(shapirop,c(shapiro.test(testcml)$p.value,shapiro.test(testeb)$p.value))
}
print(shapirop)
x1=rep(c(1,2,3),10)
x2=rep(c(1,2,3),10)
y=x1+x2+0.5*x1*x2+rnorm(30)
lm(y~as.factor(x1)+as.factor(x2)+as.factor(x1)*as.factor(x2))
x1=sample(c(1,2,3),30)
x1=sample(c(1,2,3),30,replace=T)
x1
x1=sample(c(1,2,3),30,replace=T)
x2=sample(c(1,2,3),30,replace=T)
y=x1+x2+0.5*x1*x2+rnorm(30)
lm(y~as.factor(x1)+as.factor(x2)+as.factor(x1)*as.factor(x2))
lm(y~as.factor(x1)*as.factor(x2))
exp(-5.66+50*0.06)/(1+exp(-5.66+50*0.06))
exp(0.31+60*0.01)
qchisq(0.95,5)
qnorm(0.975)
qchisq(0.95,2)
39.6-1.96*9.1
39.6+1.96*9.1
-328127+324.6*2016-0.08*2016^2
-7798+3.96*1995
-328127+324.6*2016-0.08*2016^2
-328127+324.6*2016-0.08*2016*2016
-328127+324.6*2016-0.8*2016*2016
-328127+324.6*2016-0.08*2016*2016
exp(0.01)
exp(0.04)
exp(2*1.013)
2*(1.013-1.96*0.046)
2*(1.013+1.96*0.046)
exp(1.846)
exp(2.206)
exp(1.805-1.96*0.093)
exp(1.805+1.96*0.093)
exp(10*-0.032282+0.001052*10*50)
exp(10*-0.032282+0.001052*10*60)
exp(10*-0.032282+0.001052*10*70)
N=3000
x1=rnorm(N,mean=0,sd=1)
x2=rnorm(N,mean=0,sd=1)
x3=rnorm(N,mean=0,sd=1)
x4=sample(c(1,2,3,4),N,replace=T)
N=3000
x1=rnorm(N,mean=0,sd=1)
x2=rnorm(N,mean=0,sd=1)
x3=rnorm(N,mean=0,sd=1)
x4_raw=sample(c(1,2,3,4),N,replace=T)
x4_hot=c()
cat_range=unique(x4_raw)
for (j in 1:length(cat_range)){
x4_hot=cbind(x4_hot,as.numeric(x4_raw==cat_range[j]))
}
View(x4_hot)
inter1=x1*x2
x1[1]*x2[1]
x1[2]*x2[2]
inter2=x3*x4_hot
View(x4_hot)
View(x4_hot)
inter1=x1*x2
inter2=c()
for (i in 1:N){
inter2=rbind(inter2,x3[i]*x4_hot[i,])
}
View(inter2)
X=cbind(x1,x2,x3,x4_hot,inter1,inter2)
View(X)
View(X)
beta=c(0.1,-0.1,0.1,-0.1,0.1,-0.1,0.1,2,0.5,1,1.5,2)
eta=X%*%beta
var(eta)
eta=X%*%beta+rnorm(N,mean=0,sd=0.5)
p=exp(eta)/(1+exp(eta))
mean(p)
c(3,4)/c(1,2)
X=cbind(x1,x2,x3,x4_hot,inter1,inter2)
beta=c(0.1,-0.1,0.1,-0.1,0.1,-0.1,0.1,2,0.5,1,1.5,2)
eta=0.5+X%*%beta+rnorm(N,mean=0,sd=1)
p=exp(eta)/(1+exp(eta))
p=exp(eta)/(1+exp(eta))
mean(p)
X=cbind(x1,x2,x3,x4_hot,inter1,inter2)
beta=c(0.1,-0.1,0.1,-0.1,0.1,-0.1,0.1,2,0.5,1,1.5,2)
eta=-0.5+X%*%beta+rnorm(N,mean=0,sd=1)
p=exp(eta)/(1+exp(eta))
mean(p)
Y=as.numeric(p>0.5)
setwd("~/GitHub/MIT6.867/Code")
write.csv(data,"~/GitHub/MIT6.867/Data",row.names = F)
data=cbind(Y,X)
write.csv(data,"~/GitHub/MIT6.867/Data/sim_g.csv",row.names = F)
