testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(2,1,4,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(2,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(5,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(8,1,2,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml);qqline(testeb,col='red')
qqnorm(testeb);qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML,G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB,G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
}
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
}
shapiro.test(testcml)
a=shapiro.test(testcml)
a$p.value
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
shapirop=c()
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
shapirop=c(shapirop,c(shapiro.test(testcml)$p.value,shapiro.test(testeb)$p.value))
}
print(shapirop)
MORG=1.1;MORE=1.2;RERI=0;pE=0.1;pG=0.05
N0=50000;N1=50000;n=2000
par(mfrow=c(3,2),mar=c(3,1,1.5,1),pin=c(1.1,1.1))
shapirop=c()
for (EXPTHETA in c(0.9,1,1.1)){
dat=gen_data(pE,pG,EXPTHETA,MORG,MORE,RERI,N0,N1,n)
testcml=rep(0,n);testeb=rep(0,n)
for(k in 1:n){
r01=dat$sim0[1,k]
r02=dat$sim0[2,k]
r03=dat$sim0[3,k]
r04=dat$sim0[4,k]
r11=dat$sim1[1,k]
r12=dat$sim1[2,k]
r13=dat$sim1[3,k]
r14=dat$sim1[4,k]
temp_cml=add.cml(r01,r02,r03,r04,r11,r12,r13,r14)
temp_eb=add.eb(r01,r02,r03,r04,r11,r12,r13,r14)
testcml[k]=temp_cml$reri/temp_cml$sd
testeb[k]=temp_eb$reri/temp_eb$sd
}
qqnorm(testcml,main=paste0('CML, G-E=',EXPTHETA));qqline(testeb,col='red')
qqnorm(testeb,main=paste0('EB, G-E=',EXPTHETA));qqline(testeb,col='red')
shapirop=c(shapirop,c(shapiro.test(testcml)$p.value,shapiro.test(testeb)$p.value))
}
print(shapirop)
x1=rep(c(1,2,3),10)
x2=rep(c(1,2,3),10)
y=x1+x2+0.5*x1*x2+rnorm(30)
lm(y~as.factor(x1)+as.factor(x2)+as.factor(x1)*as.factor(x2))
x1=sample(c(1,2,3),30)
x1=sample(c(1,2,3),30,replace=T)
x1
x1=sample(c(1,2,3),30,replace=T)
x2=sample(c(1,2,3),30,replace=T)
y=x1+x2+0.5*x1*x2+rnorm(30)
lm(y~as.factor(x1)+as.factor(x2)+as.factor(x1)*as.factor(x2))
lm(y~as.factor(x1)*as.factor(x2))
exp(-5.66+50*0.06)/(1+exp(-5.66+50*0.06))
exp(0.31+60*0.01)
qchisq(0.95,5)
qnorm(0.975)
qchisq(0.95,2)
39.6-1.96*9.1
39.6+1.96*9.1
-328127+324.6*2016-0.08*2016^2
-7798+3.96*1995
-328127+324.6*2016-0.08*2016^2
-328127+324.6*2016-0.08*2016*2016
-328127+324.6*2016-0.8*2016*2016
-328127+324.6*2016-0.08*2016*2016
exp(0.01)
exp(0.04)
exp(2*1.013)
2*(1.013-1.96*0.046)
2*(1.013+1.96*0.046)
exp(1.846)
exp(2.206)
exp(1.805-1.96*0.093)
exp(1.805+1.96*0.093)
exp(10*-0.032282+0.001052*10*50)
exp(10*-0.032282+0.001052*10*60)
exp(10*-0.032282+0.001052*10*70)
library(bnstruct)
setwd("~/GitHub/MIT6.867/Data")
trainset = read.csv("train.csv",header=T)
setwd("~/GitHub/MIT6.867/Data")
data = read.csv("trainset_impute50000.csv",header=T)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
f=cbind(a,b,d)
colnames(f)=c("a","b","d")
f=data.frame(f)
View(f)
install.packages("reshape2")
library(reshape2)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
View(f)
f(melt(dt, id.vars='id'), id ~ a + b, fun = length)
dcast(melt(f, id.vars='id'), id ~ a + b, fun = length)
melt(f)
i=1
cat_var=f[,cat_varname[i]]
cat_varname=c("a","d")
cat_var=f[,cat_varname[i]]
cat_var
f=f[,-cat_varname[i]]
f=f[,!cat_varname[i]]
f=f[,!(cat_varname[i])]
drop = cat_varname[i]
cat_var=f[,drop]
f=f[ , !(names(f) %in% drop)]
View(f)
cat_range=unique(cat_var)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
View(one_hot)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
View(one_hot)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
for (i in 1:length(cat_varname)){
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
f=cbind(f,one_hot)
}
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
View(one_hot)
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
View(one_hot)
one_hot=data.frame(one_hot)
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
View(one_hot)
a=c(1,2,3,1,2,3,4,1,2,3)
b=c(1,2,3,4,1,2,3,4,1,2)
d=c(1,2,3,1,2,3,3,1,2,1)
id=c(1,2,3,4,5,6,7,8,9,10)
f=cbind(id,a,b,d)
colnames(f)=c("id","a","b","d")
f=data.frame(f)
for (i in 1:length(cat_varname)){
one_hot=c()
drop = cat_varname[i]
cat_var=f[,drop]
f=f[,!(names(f) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
one_hot=data.frame(one_hot)
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
f=cbind(f,one_hot)
}
View(f)
data = read.csv("trainset_impute50000.csv",header=T)
cat_varname=c('ps_ind_02_cat','ps_ind_04_cat','ps_ind_05_cat','ps_ind_06_bin','ps_ind_07_bin',
'ps_ind_08_bin','ps_ind_09_bin','ps_ind_10_bin','ps_ind_11_bin','ps_ind_12_bin',
'ps_ind_13_bin','ps_ind_16_bin','ps_ind_17_bin','ps_ind_18_bin','ps_car_01_cat',
'ps_car_02_cat','ps_car_03_cat','ps_car_04_cat','ps_car_05_cat','ps_car_06_cat',
'ps_car_07_cat','ps_car_08_cat','ps_car_09_cat','ps_car_10_cat','ps_car_11_cat',
'ps_calc_15_bin','ps_calc_16_bin','ps_calc_17_bin','ps_calc_18_bin','ps_calc_19_bin',
'ps_calc_20_bin')
for (i in 1:length(cat_varname)){
one_hot=c()
drop = cat_varname[i]
cat_var=data[,drop]
data=data[,!(names(data) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
one_hot=data.frame(one_hot)
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
data=cbind(data,one_hot)
}
View(data)
View(data)
write.csv(data,"trainset_impute_onehot.csv",row.names = F)
data = read.csv("testset_impute50000.csv",header=T)
cat_varname=c('ps_ind_02_cat','ps_ind_04_cat','ps_ind_05_cat','ps_ind_06_bin','ps_ind_07_bin',
'ps_ind_08_bin','ps_ind_09_bin','ps_ind_10_bin','ps_ind_11_bin','ps_ind_12_bin',
'ps_ind_13_bin','ps_ind_16_bin','ps_ind_17_bin','ps_ind_18_bin','ps_car_01_cat',
'ps_car_02_cat','ps_car_03_cat','ps_car_04_cat','ps_car_05_cat','ps_car_06_cat',
'ps_car_07_cat','ps_car_08_cat','ps_car_09_cat','ps_car_10_cat','ps_car_11_cat',
'ps_calc_15_bin','ps_calc_16_bin','ps_calc_17_bin','ps_calc_18_bin','ps_calc_19_bin',
'ps_calc_20_bin')
for (i in 1:length(cat_varname)){
one_hot=c()
drop = cat_varname[i]
cat_var=data[,drop]
data=data[,!(names(data) %in% drop)]
cat_range=unique(cat_var)
for (j in 1:length(cat_range)){
one_hot=cbind(one_hot,as.numeric(cat_var==cat_range[j]))
}
one_hot=data.frame(one_hot)
for (j in 1:length(cat_range)){
colnames(one_hot)[j]=paste0(drop,"_",cat_range[j])
}
data=cbind(data,one_hot)
}
colnames(data)[1]='id'
write.csv(data,"testset_impute_onehot.csv",row.names = F)
